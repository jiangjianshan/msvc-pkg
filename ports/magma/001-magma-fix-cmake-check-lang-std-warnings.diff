diff -urN magma-2.8.0-orig/CMakeLists.txt magma-2.8.0/CMakeLists.txt
--- magma-2.8.0-orig/CMakeLists.txt	2024-03-28 20:23:41.000000000 +0800
+++ magma-2.8.0/CMakeLists.txt	2025-01-21 16:01:18.392955700 +0800
@@ -65,20 +65,34 @@
 # see http://stackoverflow.com/questions/10851247/how-to-activate-c-11-in-cmake
 include(CheckCXXCompilerFlag)
 include(CheckCCompilerFlag)
-CHECK_CXX_COMPILER_FLAG("-std=c++11" COMPILER_SUPPORTS_CXX11)
-CHECK_CXX_COMPILER_FLAG("-std=c++0x" COMPILER_SUPPORTS_CXX0X)
+if (MSVC)
+  CHECK_CXX_COMPILER_FLAG("-std:c++14" COMPILER_SUPPORTS_CXX11)
+else()
+  CHECK_CXX_COMPILER_FLAG("-std=c++11" COMPILER_SUPPORTS_CXX11)
+  CHECK_CXX_COMPILER_FLAG("-std=c++0x" COMPILER_SUPPORTS_CXX0X)
+endif()
 CHECK_CXX_COMPILER_FLAG("-fPIC" COMPILER_SUPPORTS_FPIC)
 if (COMPILER_SUPPORTS_CXX11)
+  if (NOT MSVC)
     set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++11")
+  endif()
 elseif(COMPILER_SUPPORTS_CXX0X)
     set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++0x")
 else()
     message( WARNING "The compiler ${CMAKE_CXX_COMPILER} doesn't support the -std=c++11 flag. Some code may not compile.")
 endif()
 
-CHECK_C_COMPILER_FLAG("-std=c99" COMPILER_SUPPORTS_C99)
+if (MSVC)
+  CHECK_C_COMPILER_FLAG("-std:c17" COMPILER_SUPPORTS_C99)
+else()
+  CHECK_C_COMPILER_FLAG("-std=c99" COMPILER_SUPPORTS_C99)
+endif()
 if (COMPILER_SUPPORTS_C99)
+  if (MSVC)
+    set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -std:c17")
+  else()
     set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -std=c99")
+  endif()
 else()
     message( WARNING "The compiler ${CMAKE_C_COMPILER} doesn't support the -std=c99 flag. Some code may not compile.")
 endif()
